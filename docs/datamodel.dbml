// created with dbdiagram.io: https://dbdiagram.io/d/5e9071c539d18f5553fd6860

Table initiatives as I{
  id int [pk]
  created_at timestamp [not null]
  updated_at timestamp [not null]
  began_at timestamp [note: 'indicate since when the initiatieve is active']
  stopped_at timestamp [note: 'indicate when the initiatieve stopped']
  name varchar [not null]
  description char(20)
  type_id int [ref: > types.id]
  scale scale
  url varchar
  phone char[16] [unique]
  address varchar [note: 'should be split up fully more probably']
  latitude float(8,5) [note: 'depending on store using a spatial datatype is preferred']
  longitude float(8,5)
  // Tags provide for flexibility are not ideal for querying
  tags varchar [note: 'simple comma separated list maybe allows for flexibility']
  notes varchar [note: 'as long as we are not keeping scores formally this info should end up here']
  
//   Indexes {
    //(merchant_id, status) [name:'product_status']
//    id [unique]
//  }
}

Table types as t {
  id int [pk, increment]
  created_at timestamp [not null]
  updated_at timestamp [not null]
  name varchar [not null]
}

Table categories as C {
  id int [pk, increment]
  parent_id int [not null, ref: > C.id]
  created_at timestamp [not null]
  updated_at timestamp [not null]
  name varchar
}

Table initiative_categories
{
  initiative_id int [not null, ref: > I.id]
  category_id int [not null, ref: > C.id]
  created_at timestamp [not null]
  updated_at timestamp [not null]
}

enum scale {
  neighbourhood
  city // Often city and municipality are equal.
  municipality
  region
  province
  country
}

Table initiative_links {
  source_initiative_id int [ref: > I.id]
  target_initiative_id int [ref: > I.id]
  created_at timestamp [not null]
  updated_at timestamp [not null]
  type linktype [not null, note: 'various type of edges in a graph of initiatives']
}

// initiatives can relate to each other in many way
enum linktype{
  child_of
  parent_of
  presence_on
  collaborates_with
}

Table contacts as CT {
  id int [pk, increment] // auto-increment
  created_at timestamp [not null]
  updated_at timestamp [not null]
  full_name varchar
  email varchar
  phone varchar
  // no address to limit privacy related data.
}


Table initiative_contacts
{
  initiative_id int [not null, ref: > I.id]
  contact_id int [not null, ref: > CT.id]
  created_at timestamp
  updated_at timestamp
}

// I was thinking about desiging the a user system
// so contacts can edit their organisations, but this
// is possibly easier when we simply have this redacted
// and a contact merely changing data.

// It feels to early to properly design this.
Table Stats as S {
  id int [pk ]
  initiative_id int [not null, ref: > I.id]
  record_date datetime
  value int
  precision int [note: 'given it should allow for storage of any numerical data an indicator is needed regardless of using a floating point number or an int']
  unit varchar [note: 'level of flexibility here also unclear']
}

